<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>防災診断</title>

<style>
body{
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  margin:0;
  padding:20px;
  background:#f4f6f9;
}

h2{
  margin-top:30px;
}

/* ========================
   進捗バー
======================== */
.progress-container{
  background:#e0e0e0;
  border-radius:20px;
  overflow:hidden;
  margin:15px 0 25px 0;
  height:18px;
}

.progress-bar{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#4caf50,#81c784);
  transition:0.3s;
}

.progress-text{
  font-size:0.9em;
  margin-bottom:5px;
}

/* ========================
   カード
======================== */
.items{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
}

.item-card{
  width:100%;
  background:#fff;
  border-radius:12px;
  padding:12px;
  box-shadow:0 4px 10px rgba(0,0,0,0.05);
  display:flex;
  justify-content:space-between;
  align-items:center;
  transition:0.2s;
  position:relative;
}

.item-card.checked{
  opacity:0.5;
}

.item-left{
  display:flex;
  align-items:center;
  gap:10px;
}

.item-left input{
  transform:scale(1.2);
}

.item-name{
  font-size:0.95em;
}

/* ========================
   カラータグ
======================== */
.tag{
  font-size:0.7em;
  padding:3px 8px;
  border-radius:20px;
  color:#fff;
  margin-right:6px;
}

.tag-earthquake{background:#e53935;}
.tag-rain{background:#1e88e5;}
.tag-snow{background:#90caf9;}
.tag-typhoon{background:#8e24aa;}
.tag-tsunami{background:#0d47a1;}
.tag-volcano{background:#f4511e;}
.tag-landslide{background:#6d4c41;}
.tag-generic{background:#546e7a;}

@media(min-width:600px){
  .item-card{
    width:calc(50% - 6px);
  }
}
</style>
</head>

<body>

<h1>防災グッズ診断</h1>

<label>
<input type="checkbox" id="toggleCheckbox" checked>
持ち物確認用のチェックボックスを表示
</label>

<div id="result"></div>

<script>

/* ========================
   データ
======================== */

const disasterData = {
  "地震対策": ["耐震マット","家具転倒防止器具","ヘルメット"],
  "豪雨対策": ["止水板","防水土のう","レインコート"],
  "大雪対策": ["スノーブーツ","スコップ","滑り止め"],
  "台風・突風対策": ["窓ガラス飛散防止フィルム","養生テープ"],
  "津波対策": ["ライフジャケット","防水バッグ"],
  "噴火対策": ["防塵マスク","ゴーグル"],
  "土砂災害対策": ["ヘッドライト","非常用ロープ"]
};

const genericItems = ["保存水","非常食","モバイルバッテリー","懐中電灯","救急セット"];

/* ========================
   タグクラス
======================== */

function getTagClass(name){
  if(name.includes("地震")) return "tag-earthquake";
  if(name.includes("豪雨")) return "tag-rain";
  if(name.includes("大雪")) return "tag-snow";
  if(name.includes("台風")) return "tag-typhoon";
  if(name.includes("津波")) return "tag-tsunami";
  if(name.includes("噴火")) return "tag-volcano";
  if(name.includes("土砂")) return "tag-landslide";
  return "tag-generic";
}

/* ========================
   表示処理
======================== */

function render(){

  const result = document.getElementById("result");
  const showCheckbox = document.getElementById("toggleCheckbox").checked;
  result.innerHTML="";

  let allItems=[];

  // 汎用
  result.innerHTML += "<h2>汎用防災グッズ</h2>";
  result.innerHTML += createSection("汎用", genericItems, "tag-generic");

  // 災害別
  result.innerHTML += "<h2>想定する災害</h2>";

  for(let disaster in disasterData){
    result.innerHTML += createSection(disaster, disasterData[disaster], getTagClass(disaster));
  }

  updateProgress();
}

function createSection(title, items, tagClass){

  let html = `
  <div class="progress-text">${title} 所持率 <span id="progress-${title}">0%</span></div>
  <div class="progress-container">
    <div class="progress-bar" id="bar-${title}"></div>
  </div>
  <div class="items">`;

  items.forEach(item=>{
    html+=`
    <div class="item-card">
      <div class="item-left">
        <input type="checkbox" class="item-check" data-group="${title}">
        <span class="tag ${tagClass}">${title}</span>
        <span class="item-name">${item}</span>
      </div>
    </div>`;
  });

  html+="</div>";
  return html;
}

/* ========================
   進捗計算
======================== */

function updateProgress(){

  const groups = document.querySelectorAll(".progress-text span");

  groups.forEach(span=>{
    const title = span.id.replace("progress-","");
    const checks = document.querySelectorAll(`input[data-group="${title}"]`);
    const checked = document.querySelectorAll(`input[data-group="${title}"]:checked`);
    const percent = checks.length ? Math.round((checked.length/checks.length)*100) : 0;

    span.textContent = percent+"%";
    document.getElementById("bar-"+title).style.width = percent+"%";
  });

  document.querySelectorAll(".item-check").forEach(cb=>{
    cb.closest(".item-card").classList.toggle("checked", cb.checked);
  });
}

/* ========================
   イベント
======================== */

document.addEventListener("change", function(e){
  if(e.target.classList.contains("item-check")){
    updateProgress();
  }
});

document.getElementById("toggleCheckbox").addEventListener("change", render);

render();

</script>
</body>
</html>
